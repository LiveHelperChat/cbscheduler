(window.webpackJsonpLHCReactAPPCBScheduler=window.webpackJsonpLHCReactAPPCBScheduler||[]).push([[2],{58:function(e,t,a){"use strict";a.r(t);var l=a(2),n=a.n(l),c=a(17),s=a.n(c),r=a(0),i=a.n(r),o=a(18),m=a.n(o),u=a(27),d=a(59),f=i.a.memo((function(e){var t=Object(d.a)("cbsheduler_chat"),a=t.t,l=(t.i18n,Object(r.useState)(""!=e.phone&&null!=e.phone?e.phone:null)),n=s()(l,2),c=n[0],o=n[1],f=Object(r.useState)(""!=e.email&&null!=e.email?e.email:null),b=s()(f,2),h=b[0],p=b[1],v=Object(r.useState)(""!=e.username&&null!=e.username&&"Visitor"!=e.username&&"undefined"!=e.username?e.username:null),E=s()(v,2),g=E[0],N=E[1],_=Object(r.useState)(!1),j=s()(_,2),O=j[0],y=j[1],S=Object(r.useState)(!1),C=s()(S,2),k=C[0],x=(C[1],Object(r.useState)(!1)),w=s()(x,2),z=w[0],T=w[1],V=Object(r.useState)(null),F=s()(V,2),D=F[0],L=F[1],M=Object(r.useState)([]),P=s()(M,2),A=P[0],I=P[1],B=Object(r.useState)(null),H=s()(B,2),J=H[0],R=H[1],Y=Object(r.useState)(null),Q=s()(Y,2),U=(Q[0],Q[1]),Z=function(){e.setCancelMode(!1)},q=function(){y(!0),m.a.post(e.base_path+"cbscheduler/cancelschedulecb","undefined"!=typeof postData?postData:{username:g,timezone:e.timezone,phone:c,email:h,dep_id:e.dep_id,chat_id:e.chat_id,hash:e.hash}).then((function(e){I([]),R(null),U(null),1==e.data.error?(y(!1),e.data.messages&&I(e.data.messages),e.data.code&&U(e.data.code),e.data.message&&R(e.data.message)):(L(e.data.data),T(!0))}))};return i.a.createElement("div",null,i.a.createElement("div",{className:"row"},e.logoFormated),z&&i.a.createElement("div",null,i.a.createElement("div",{className:"alert alert-info",role:"alert"},D.message),i.a.createElement("div",{className:"form-group mb-0"},i.a.createElement("button",{type:"button",onClick:function(){return Z()},className:"btn btn-sm text-secondary btn-link pull-right"},"« ",a("fields.return")))),!z&&i.a.createElement("div",null,J&&i.a.createElement("div",{className:"alert alert-danger",role:"alert"},J),i.a.createElement("div",{className:"form-group"},i.a.createElement(u.a,{countries:null!==e.countries?e.countries:void 0,international:!0,className:"form-control form-control-sm"+(A.phone?" is-invalid":""),defaultCountry:e.defaultCountry,placeholder:a("fields.enter_phone"),value:c,onChange:o}),A.phone&&i.a.createElement("div",{className:"invalid-feedback"},A.phone),i.a.createElement("small",null,i.a.createElement("i",null,a("fields.include_country")))),i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6 pr-2"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{title:a("fields.username"),placeholder:a("fields.username"),type:"text",maxLength:"250",onChange:function(e){return N(e.target.value)},className:"form-control form-control-sm"+(A.username?" is-invalid":""),defaultValue:g}),A.username&&i.a.createElement("div",{className:"invalid-feedback"},A.username))),i.a.createElement("div",{className:"pl-2 col-6"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{title:a("fields.email"),placeholder:a("fields.email"),type:"text",maxLength:"250",defaultValue:h,onChange:function(e){return p(e.target.value)},className:"form-control form-control-sm"+(A.email?" is-invalid":"")}),A.email&&i.a.createElement("div",{className:"invalid-feedback"},A.email)))),i.a.createElement("div",{className:"form-group mb-0"},i.a.createElement("button",{type:"button",disabled:k||O,className:"btn btn-sm btn-secondary",onClick:function(){return q()}},O&&i.a.createElement("i",{className:"material-icons"},"")," ",a("fields.cancel_action")),i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:function(){return Z()},className:"btn btn-sm text-secondary btn-link pull-right"},"« ",a("fields.return"))))))}));t.default=function(e){var t,a=Object(r.useState)([]),l=s()(a,2),c=l[0],o=l[1],b=Object(r.useState)([]),h=s()(b,2),p=h[0],v=h[1],E=Object(r.useState)([]),g=s()(E,2),N=g[0],_=g[1],j=Object(r.useState)([]),O=s()(j,2),y=O[0],S=O[1],C=Object(r.useState)(null),k=s()(C,2),x=k[0],w=k[1],z=Object(r.useState)(null),T=s()(z,2),V=T[0],F=T[1],D=Object(r.useState)(null),L=s()(D,2),M=L[0],P=L[1],A=Object(r.useState)(null),I=s()(A,2),B=I[0],H=I[1],J=Object(r.useState)(null),R=s()(J,2),Y=R[0],Q=R[1],U=Object(r.useState)(null),Z=s()(U,2),q=Z[0],G=Z[1],K=Object(r.useState)(""!=e.username&&null!=e.username&&"Visitor"!=e.username&&"undefined"!=e.username?e.username:null),W=s()(K,2),X=W[0],$=W[1],ee=Object(r.useState)(""!=e.subject&&null!=e.subject?e.subject:null),te=s()(ee,2),ae=te[0],le=te[1],ne=Object(r.useState)(""!=e.description&&null!=e.description?e.description:null),ce=s()(ne,2),se=ce[0],re=ce[1],ie=Object(r.useState)(""!=e.phone&&null!=e.phone?e.phone:null),oe=s()(ie,2),me=oe[0],ue=oe[1],de=Object(r.useState)(""!=e.email&&null!=e.email?e.email:null),fe=s()(de,2),be=fe[0],he=fe[1],pe=Object(r.useState)(null),ve=s()(pe,2),Ee=ve[0],ge=ve[1],Ne=Object(r.useState)(e.dep_id),_e=s()(Ne,2),je=_e[0],Oe=_e[1],ye=Object(r.useState)(null),Se=s()(ye,2),Ce=Se[0],ke=Se[1],xe=Object(r.useState)(!1),we=s()(xe,2),ze=we[0],Te=we[1],Ve=Object(r.useState)(!1),Fe=s()(Ve,2),De=Fe[0],Le=(Fe[1],Object(r.useState)(!1)),Me=s()(Le,2),Pe=Me[0],Ae=Me[1],Ie=Object(r.useState)(!1),Be=s()(Ie,2),He=Be[0],Je=Be[1],Re=Object(r.useState)(null),Ye=s()(Re,2),Qe=Ye[0],Ue=Ye[1],Ze=Object(r.useState)(null),qe=s()(Ze,2),Ge=qe[0],Ke=qe[1],We=Object(r.useState)(null),Xe=s()(We,2),$e=Xe[0],et=Xe[1],tt=Object(r.useState)(!1),at=s()(tt,2),lt=at[0],nt=at[1],ct=Object(r.useState)(!1),st=s()(ct,2),rt=st[0],it=st[1],ot=Object(r.useState)(0),mt=s()(ot,2),ut=mt[0],dt=mt[1],ft=function(){e.ee.emitEvent("endCheduler",[e])},bt=Object(r.useState)(function(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;return"undefined"==e&&(e="UTC"),e}catch(e){Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1),t=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};var t=new Date;return(t.dst()?t.getTimezoneOffset():t.getTimezoneOffset()-60)/60*-1}}()),ht=s()(bt,2),pt=ht[0],vt=(ht[1],function(e){Te(e)}),Et=function(){return{username:X,timezone:pt,dep_id:je,chat_id:e.chat_id,parent_id:e.parent_id,hash:e.hash,subject:ae,description:se,phone:me,email:be,day:M,time:B,attempt:ut,terms_agree:rt}},gt=function(t){Ae(!0),m.a.post(e.base_path+"cbscheduler/schedulecb",void 0!==t?t:Et()).then((function(e){S([]),w(null),F(null),1==e.data.error?(Ae(!1),e.data.messages&&(S(e.data.messages),e.data.messages.errorModal&&dt(ut+1)),e.data.code&&F(e.data.code),e.data.message&&w(e.data.message)):(Ue(e.data.data),Je(!0))}))};Object(r.useEffect)((function(){null!==M&&(v([]),H(null),m.a.get(e.base_path+"cbscheduler/gettimes/"+M+"/(department)/"+je+"/(chat)/"+e.chat_id+"?tz="+pt).then((function(e){v(e.data),H(null)})))}),[M]),Object(r.useEffect)((function(){m.a.get(e.base_path+"cbscheduler/getdays/(department)/"+je+"/(chat)/"+e.chat_id+"/(hash)/"+e.hash+"/(vid)/"+e.vid+"/(theme)/"+e.theme+"?tz="+pt).then((function(t){o(t.data.days),Ke(t.data.default_country),et(t.data.logo),t.data.username&&(null===X||e.chat_id)&&$(t.data.username),t.data.email&&he(t.data.email),t.data.countries&&ge(t.data.countries),t.data.terms_of_service&&ke(t.data.terms_of_service),null===je&&Oe(t.data.department),nt(!0)})),m.a.get(e.base_path+"cbscheduler/getsubjects").then((function(e){_(e.data)}))}),[]);var Nt=Object(d.a)("cbsheduler_chat"),_t=Nt.t;Nt.i18n;if(!1===lt)return i.a.createElement(i.a.Fragment,null,"...");var jt=i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"d-flex pb-1"},null!==$e&&i.a.createElement("div",null,i.a.createElement("img",{src:$e,height:"40"})),i.a.createElement("div",{className:"pl-0 pt-1 flex-grow-1"},i.a.createElement("h5",null,_t("fields.schedule_title"))),"widget"==e.mode&&i.a.createElement("div",{className:"pl-2"},i.a.createElement("button",{type:"button",onClick:function(e){return ft()},className:"close float-right","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"×")))));return y.errorModal?i.a.createElement(i.a.Fragment,null,jt,i.a.createElement("p",{className:"text-danger"},y.errorModal),i.a.createElement("div",{className:"btn-group"},!y.disableTryAgain&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(e){return S([])}},_t("fields.try_again")),"widget"==e.mode&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(t){m.a.post(e.base_path+"cbscheduler/gotoagent",Et()).then((function(t){e.ee.emitEvent("cbscheduler.live_support",[{chat_id:e.chat_id,fields:{Question:_t("fields.verification_failed")}}]),ft()}))}},_t("fields.live_support")),"widget"!=e.mode&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(e){return ft()}},_t("fields.close")))):0==c.length?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},jt,i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"alert alert-light",role:"alert"},_t("fields.no_free_days"))))):!0===ze?i.a.createElement(f,{username:X,phone:me,email:be,base_path:e.base_path,timezone:pt,dep_id:je,chat_id:e.chat_id,hash:e.hash,countries:null!==Ee?Ee:void 0,logoFormated:jt,setCancelMode:function(){return vt(!1)},defaultCountry:Ge}):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},jt,He&&i.a.createElement("div",{className:"col-12"},_t("fields.call_scheduled")," ",i.a.createElement("a",{href:Qe.ics},_t("fields.download")),"."),!He&&i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6 pr-2"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{title:_t("fields.username"),placeholder:_t("fields.username"),type:"text",maxLength:"250",onChange:function(e){return $(e.target.value)},className:"form-control form-control-sm"+(y.username?" is-invalid":""),defaultValue:X}),y.username&&i.a.createElement("div",{className:"invalid-feedback"},y.username))),i.a.createElement("div",{className:"pl-2 col-6"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{title:_t("fields.email"),placeholder:_t("fields.email"),type:"text",maxLength:"250",defaultValue:be,onChange:function(e){return he(e.target.value)},className:"form-control form-control-sm"+(y.email?" is-invalid":"")}),y.email&&i.a.createElement("div",{className:"invalid-feedback"},y.email)))),i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{title:_t("fields.subject"),className:"form-control form-control-sm"+(y.subject?" is-invalid":""),defaultValue:ae,onChange:function(e){return le(e.target.value)}},i.a.createElement("option",{value:""},_t("fields.choose_subject")),N.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),y.subject&&i.a.createElement("div",{className:"invalid-feedback"},y.subject)),i.a.createElement("div",{className:"form-group"},i.a.createElement(u.a,{countries:null!==Ee?Ee:void 0,international:!0,className:"form-control form-control-sm"+(y.phone?" is-invalid":""),defaultCountry:Ge,placeholder:_t("fields.enter_phone"),value:me,onChange:ue}),y.phone&&i.a.createElement("div",{className:"invalid-feedback"},y.phone),i.a.createElement("small",null,i.a.createElement("i",null,_t("fields.include_country")))),i.a.createElement("div",{className:"form-group mb-1"},i.a.createElement("textarea",{placeholder:_t("fields.problem"),maxLength:"500",name:"description",defaultValue:se,onChange:function(e){return re(e.target.value)},className:"form-control form-control-sm"+(y.description?" is-invalid":"")}),y.description&&i.a.createElement("div",{className:"invalid-feedback"},y.description)),i.a.createElement("p",{className:"mb-2"},i.a.createElement("small",null,_t("fields.choose_day_time",{timezone:pt}))),i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{className:"form-control form-control-sm"+(y.day?" is-invalid":""),defaultValue:M,onChange:function(e){return function(e){w(null),F(null),e.target.value&&G(e.target.options[e.target.selectedIndex].text),P(e.target.value)}(e)}},i.a.createElement("option",{value:""},_t("fields.choose_day")),c.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),y.day&&i.a.createElement("div",{className:"invalid-feedback"},y.day)),M&&p.length>0&&i.a.createElement("div",{className:"form-group"},i.a.createElement("select",(t={className:"form-control form-control-sm",defaultValue:B},n()(t,"className","form-control form-control-sm"+(y.time?" is-invalid":"")),n()(t,"onChange",(function(e){return function(e){e.target.value?Q(e.target.options[e.target.selectedIndex].text.replace(" - "," "+_t("fields.and")+" ")):(w(null),F(null)),H(e.target.value)}(e)})),t),i.a.createElement("option",{value:""},_t("fields.choose_time")),p.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),y.time&&i.a.createElement("div",{className:"invalid-feedback"},y.time)),M&&0==p.length&&i.a.createElement("div",{className:"form-group"},i.a.createElement("i",{className:"material-icons"},"")," ",_t("fields.loading")),x&&i.a.createElement("div",{className:"alert alert-danger",role:"alert"},x,V&&100==V&&i.a.createElement("div",{className:"pt-3"},i.a.createElement("div",{className:"pb-1"},_t("fields.reschedule_option")," ",q," ",_t("fields.between")," ",Y,"?"),i.a.createElement("button",{type:"button",disabled:De||Pe,onClick:function(){return function(){var e=Et();e.reschedule=!0,gt(e)}()},className:"btn btn-sm btn-info"},Pe&&i.a.createElement("i",{className:"material-icons"},"")," ",_t("fields.yes")))),Ce&&i.a.createElement("div",{className:"form-check form-check-sm pb-2"},i.a.createElement("input",{type:"checkbox",id:"id-terms-of-service",className:"form-check-input"+(y.terms_of_service?" is-invalid":""),onChange:function(e){return it(e.target.checked)}}),i.a.createElement("label",{className:"form-check-label",for:"id-terms-of-service"}," ",i.a.createElement("small",null,Ce)),y.terms_of_service&&i.a.createElement("div",{className:"invalid-feedback font-weight-bold"},y.terms_of_service)),i.a.createElement("div",{className:"form-group mb-0"},i.a.createElement("button",{type:"button",disabled:De||Pe,className:"btn btn-sm btn-secondary",onClick:function(){return gt()}},Pe&&i.a.createElement("i",{className:"material-icons"},"")," ",_t("fields.schedule_callback")),i.a.createElement("div",null,i.a.createElement("button",{type:"button",onClick:function(){return vt(!0)},className:"btn btn-sm text-secondary btn-link pull-right"},_t("fields.cancel_scheduled")))))))}}}]);
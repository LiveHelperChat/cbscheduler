(window.webpackJsonpLHCReactAPPCBScheduler=window.webpackJsonpLHCReactAPPCBScheduler||[]).push([[2],{58:function(e,t,a){"use strict";a.r(t);var l=a(2),n=a.n(l),c=a(17),s=a.n(c),r=a(0),i=a.n(r),m=a(31),o=a.n(m),u=a(53),d=a(59);t.default=function(e){var t,a=Object(r.useState)([]),l=s()(a,2),c=l[0],m=l[1],f=Object(r.useState)([]),b=s()(f,2),h=b[0],p=b[1],v=Object(r.useState)([]),E=s()(v,2),g=E[0],N=E[1],j=Object(r.useState)([]),O=s()(j,2),_=O[0],y=O[1],S=Object(r.useState)(null),C=s()(S,2),w=C[0],k=C[1],z=Object(r.useState)(null),x=s()(z,2),T=x[0],F=x[1],V=Object(r.useState)(null),D=s()(V,2),L=D[0],M=D[1],P=Object(r.useState)(""!=e.username&&null!=e.username&&"Visitor"!=e.username&&"undefined"!=e.username?e.username:null),A=s()(P,2),B=A[0],H=A[1],J=Object(r.useState)(""!=e.subject&&null!=e.subject?e.subject:null),R=s()(J,2),Y=R[0],I=R[1],Q=Object(r.useState)(""!=e.description&&null!=e.description?e.description:null),U=s()(Q,2),Z=U[0],q=U[1],G=Object(r.useState)(""!=e.phone&&null!=e.phone?e.phone:null),K=s()(G,2),W=K[0],X=K[1],$=Object(r.useState)(""!=e.email&&null!=e.email?e.email:null),ee=s()($,2),te=ee[0],ae=ee[1],le=Object(r.useState)(null),ne=s()(le,2),ce=ne[0],se=ne[1],re=Object(r.useState)(e.dep_id),ie=s()(re,2),me=ie[0],oe=ie[1],ue=Object(r.useState)(!1),de=s()(ue,2),fe=de[0],be=(de[1],Object(r.useState)(!1)),he=s()(be,2),pe=he[0],ve=he[1],Ee=Object(r.useState)(!1),ge=s()(Ee,2),Ne=ge[0],je=ge[1],Oe=Object(r.useState)(null),_e=s()(Oe,2),ye=_e[0],Se=_e[1],Ce=Object(r.useState)(null),we=s()(Ce,2),ke=we[0],ze=we[1],xe=Object(r.useState)(null),Te=s()(xe,2),Fe=Te[0],Ve=Te[1],De=Object(r.useState)(!1),Le=s()(De,2),Me=Le[0],Pe=Le[1],Ae=Object(r.useState)(0),Be=s()(Ae,2),He=Be[0],Je=Be[1],Re=function(){e.ee.emitEvent("endCheduler",[e])},Ye=Object(r.useState)(function(){try{var e=Intl.DateTimeFormat().resolvedOptions().timeZone;return"undefined"==e&&(e="UTC"),e}catch(e){Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1),t=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};var t=new Date;return(t.dst()?t.getTimezoneOffset():t.getTimezoneOffset()-60)/60*-1}}()),Ie=s()(Ye,2),Qe=Ie[0],Ue=(Ie[1],function(){return{username:B,timezone:Qe,dep_id:me,chat_id:e.chat_id,parent_id:e.parent_id,hash:e.hash,subject:Y,description:Z,phone:W,email:te,day:T,time:L,attempt:He}});Object(r.useEffect)((function(){null!==T&&(p([]),M(null),o.a.get(e.base_path+"cbscheduler/gettimes/"+T+"/(department)/"+me+"/(chat)/"+e.chat_id+"?tz="+Qe).then((function(e){p(e.data),M(null)})))}),[T]),Object(r.useEffect)((function(){o.a.get(e.base_path+"cbscheduler/getdays/(department)/"+me+"/(chat)/"+e.chat_id+"/(hash)/"+e.hash+"/(vid)/"+e.vid+"/(theme)/"+e.theme+"?tz="+Qe).then((function(t){m(t.data.days),ze(t.data.default_country),Ve(t.data.logo),t.data.username&&(null===B||e.chat_id)&&H(t.data.username),t.data.email&&ae(t.data.email),t.data.countries&&se(t.data.countries),null===me&&oe(t.data.department),Pe(!0)})),o.a.get(e.base_path+"cbscheduler/getsubjects").then((function(e){N(e.data)}))}),[]);var Ze=Object(d.a)("cbsheduler_chat"),qe=Ze.t;Ze.i18n;if(!1===Me)return i.a.createElement(i.a.Fragment,null,"...");var Ge=i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"d-flex pb-1"},null!==Fe&&i.a.createElement("div",null,i.a.createElement("img",{src:Fe,height:"40"})),i.a.createElement("div",{className:"pl-2 pt-1 flex-grow-1"},i.a.createElement("h5",null,qe("fields.schedule_title"))),"widget"==e.mode&&i.a.createElement("div",{className:"pl-2"},i.a.createElement("button",{type:"button",onClick:function(e){return Re()},className:"close float-right","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"×")))));return _.errorModal?i.a.createElement(i.a.Fragment,null,Ge,i.a.createElement("p",{className:"text-danger"},_.errorModal),i.a.createElement("div",{className:"btn-group"},!_.disableTryAgain&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(e){return y([])}},qe("fields.try_again")),"widget"==e.mode&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(t){o.a.post(e.base_path+"cbscheduler/gotoagent",Ue()).then((function(t){e.ee.emitEvent("cbscheduler.live_support",[{chat_id:e.chat_id,fields:{Question:qe("fields.verification_failed")}}]),Re()}))}},qe("fields.live_support")),"widget"!=e.mode&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(e){return Re()}},qe("fields.close")))):0==c.length?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},Ge,i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"alert alert-light",role:"alert"},qe("fields.no_free_days"))))):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},Ge,Ne&&i.a.createElement("div",{className:"col-12"},qe("fields.call_scheduled")," ",i.a.createElement("a",{href:ye.ics},qe("fields.download")),"."),!Ne&&i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6 pr-2"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{title:qe("fields.username"),placeholder:qe("fields.username"),type:"text",maxLength:"250",onChange:function(e){return H(e.target.value)},className:"form-control form-control-sm"+(_.username?" is-invalid":""),defaultValue:B}),_.username&&i.a.createElement("div",{className:"invalid-feedback"},_.username))),i.a.createElement("div",{className:"pl-2 col-6"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{title:qe("fields.email"),placeholder:qe("fields.email"),type:"text",maxLength:"250",defaultValue:te,onChange:function(e){return ae(e.target.value)},className:"form-control form-control-sm"+(_.email?" is-invalid":"")}),_.email&&i.a.createElement("div",{className:"invalid-feedback"},_.email)))),i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{title:qe("fields.subject"),className:"form-control form-control-sm"+(_.subject?" is-invalid":""),defaultValue:Y,onChange:function(e){return I(e.target.value)}},i.a.createElement("option",{value:""},qe("fields.choose_subject")),g.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),_.subject&&i.a.createElement("div",{className:"invalid-feedback"},_.subject)),i.a.createElement("div",{className:"form-group"},i.a.createElement(u.a,{countries:null!==ce?ce:void 0,international:!0,className:"form-control form-control-sm"+(_.phone?" is-invalid":""),defaultCountry:ke,placeholder:qe("fields.enter_phone"),value:W,onChange:X}),_.phone&&i.a.createElement("div",{className:"invalid-feedback"},_.phone),i.a.createElement("small",null,i.a.createElement("i",null,qe("fields.include_country")))),i.a.createElement("div",{className:"form-group mb-1"},i.a.createElement("textarea",{placeholder:qe("fields.problem"),maxLength:"500",name:"description",defaultValue:Z,onChange:function(e){return q(e.target.value)},className:"form-control form-control-sm"+(_.description?" is-invalid":"")}),_.description&&i.a.createElement("div",{className:"invalid-feedback"},_.description)),i.a.createElement("p",{className:"mb-2"},i.a.createElement("small",null,qe("fields.choose_day_time",{timezone:Qe}))),i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{className:"form-control form-control-sm"+(_.day?" is-invalid":""),defaultValue:T,onChange:function(e){return F(e.target.value)}},i.a.createElement("option",{value:""},qe("fields.choose_day")),c.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),_.day&&i.a.createElement("div",{className:"invalid-feedback"},_.day)),T&&h.length>0&&i.a.createElement("div",{className:"form-group"},i.a.createElement("select",(t={className:"form-control form-control-sm",defaultValue:L},n()(t,"className","form-control form-control-sm"+(_.time?" is-invalid":"")),n()(t,"onChange",(function(e){return M(e.target.value)})),t),i.a.createElement("option",{value:""},qe("fields.choose_time")),h.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),_.time&&i.a.createElement("div",{className:"invalid-feedback"},_.time)),T&&0==h.length&&i.a.createElement("div",{className:"form-group"},i.a.createElement("i",{className:"material-icons"},"")," ",qe("fields.loading")),w&&i.a.createElement("div",{className:"alert alert-danger",role:"alert"},w),i.a.createElement("div",{className:"form-group mb-0"},i.a.createElement("button",{type:"button",disabled:fe||pe,className:"btn btn-sm btn-secondary",onClick:function(){return ve(!0),void o.a.post(e.base_path+"cbscheduler/schedulecb",Ue()).then((function(e){y([]),k(null),1==e.data.error?(ve(!1),e.data.messages&&(y(e.data.messages),e.data.messages.errorModal&&Je(He+1)),e.data.message&&k(e.data.message)):(Se(e.data.data),je(!0))}))}},pe&&i.a.createElement("i",{className:"material-icons"},"")," ",qe("fields.schedule_callback"))))))}}}]);
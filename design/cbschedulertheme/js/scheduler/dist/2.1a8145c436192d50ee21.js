(window.webpackJsonpLHCReactAPPCBScheduler=window.webpackJsonpLHCReactAPPCBScheduler||[]).push([[2],{58:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),c=a(17),s=a.n(c),r=a(1),i=a.n(r),m=a(31),o=a.n(m),u=a(53),d=a(59);t.default=function(e){var t,a=Object(r.useState)([]),l=s()(a,2),c=l[0],m=l[1],f=Object(r.useState)([]),h=s()(f,2),b=h[0],p=h[1],v=Object(r.useState)([]),E=s()(v,2),g=E[0],N=E[1],j=Object(r.useState)([]),O=s()(j,2),_=O[0],y=O[1],S=Object(r.useState)(null),C=s()(S,2),w=C[0],k=C[1],z=Object(r.useState)(null),x=s()(z,2),T=x[0],F=x[1],V=Object(r.useState)(null),D=s()(V,2),L=D[0],M=D[1],P=Object(r.useState)(""!=e.username&&null!=e.username&&"Visitor"!=e.username&&"undefined"!=e.username?e.username:null),A=s()(P,2),B=A[0],H=A[1],J=Object(r.useState)(""!=e.subject&&null!=e.subject?e.subject:null),R=s()(J,2),Y=R[0],I=R[1],Q=Object(r.useState)(null),Z=s()(Q,2),q=Z[0],G=Z[1],K=Object(r.useState)(""!=e.phone&&null!=e.phone?e.phone:null),U=s()(K,2),W=U[0],X=U[1],$=Object(r.useState)(""!=e.email&&null!=e.email?e.email:null),ee=s()($,2),te=ee[0],ae=ee[1],le=Object(r.useState)(e.dep_id),ne=s()(le,2),ce=ne[0],se=ne[1],re=Object(r.useState)(!1),ie=s()(re,2),me=ie[0],oe=(ie[1],Object(r.useState)(!1)),ue=s()(oe,2),de=ue[0],fe=ue[1],he=Object(r.useState)(!1),be=s()(he,2),pe=be[0],ve=be[1],Ee=Object(r.useState)(null),ge=s()(Ee,2),Ne=ge[0],je=ge[1],Oe=Object(r.useState)(null),_e=s()(Oe,2),ye=_e[0],Se=_e[1],Ce=Object(r.useState)(null),we=s()(Ce,2),ke=we[0],ze=we[1],xe=Object(r.useState)(!1),Te=s()(xe,2),Fe=Te[0],Ve=Te[1],De=Object(r.useState)(0),Le=s()(De,2),Me=Le[0],Pe=Le[1],Ae=function(){e.ee.emitEvent("endCheduler",[e])},Be=Object(r.useState)(function(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1),t=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};var e=new Date;return(e.dst()?e.getTimezoneOffset():e.getTimezoneOffset()-60)/60*-1}}()),He=s()(Be,2),Je=He[0],Re=(He[1],function(){return{username:B,timezone:Je,dep_id:ce,chat_id:e.chat_id,hash:e.hash,subject:Y,description:q,phone:W,email:te,day:T,time:L,attempt:Me}});Object(r.useEffect)((function(){null!==T&&(p([]),M(null),o.a.get(e.base_path+"cbscheduler/gettimes/"+T+"/(department)/"+ce+"/(chat)/"+e.chat_id+"?tz="+Je).then((function(e){p(e.data),M(null)})))}),[T]),Object(r.useEffect)((function(){o.a.get(e.base_path+"cbscheduler/getdays/(department)/"+ce+"/(chat)/"+e.chat_id+"/(hash)/"+e.hash+"/(vid)/"+e.vid+"/(theme)/"+e.theme+"?tz="+Je).then((function(t){m(t.data.days),Se(t.data.default_country),ze(t.data.logo),t.data.username&&(null===B||e.chat_id)&&H(t.data.username),t.data.email&&ae(t.data.email),null===ce&&se(t.data.department),Ve(!0)})),o.a.get(e.base_path+"cbscheduler/getsubjects").then((function(e){N(e.data)}))}),[]);var Ye=Object(d.a)("cbsheduler_chat"),Ie=Ye.t;Ye.i18n;if(!1===Fe)return i.a.createElement(i.a.Fragment,null,"...");var Qe=i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"d-flex pb-1"},null!==ke&&i.a.createElement("div",null,i.a.createElement("img",{src:ke,height:"40"})),i.a.createElement("div",{className:"pl-2 pt-1 flex-grow-1"},i.a.createElement("h5",null,Ie("fields.schedule_title"))),"widget"==e.mode&&i.a.createElement("div",{className:"pl-2"},i.a.createElement("button",{type:"button",onClick:function(e){return Ae()},className:"close float-right","data-dismiss":"modal","aria-label":"Close"},i.a.createElement("span",{"aria-hidden":"true"},"×")))));return _.errorModal?i.a.createElement(i.a.Fragment,null,Qe,i.a.createElement("p",{className:"text-danger"},_.errorModal),i.a.createElement("div",{className:"btn-group"},!_.disableTryAgain&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(e){return y([])}},Ie("fields.try_again")),"widget"==e.mode&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(t){o.a.post(e.base_path+"cbscheduler/gotoagent",Re()).then((function(t){e.ee.emitEvent("cbscheduler.live_support",[{chat_id:e.chat_id,fields:{Question:Ie("fields.verification_failed")}}]),Ae()}))}},Ie("fields.live_support")),"widget"!=e.mode&&i.a.createElement("button",{className:"btn btn-sm btn-secondary",onClick:function(e){return Ae()}},Ie("fields.close")))):0==c.length?i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},Qe,i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"alert alert-light",role:"alert"},Ie("fields.no_free_days"))))):i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"row"},Qe,pe&&i.a.createElement("div",{className:"col-12"},Ie("fields.call_scheduled")," ",i.a.createElement("a",{href:Ne.ics},Ie("fields.download")),"."),!pe&&i.a.createElement("div",{className:"col-12"},i.a.createElement("div",{className:"row"},i.a.createElement("div",{className:"col-6 pr-2"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{title:Ie("fields.username"),placeholder:Ie("fields.username"),type:"text",maxLength:"250",onChange:function(e){return H(e.target.value)},className:"form-control form-control-sm"+(_.username?" is-invalid":""),defaultValue:B}),_.username&&i.a.createElement("div",{className:"invalid-feedback"},_.username))),i.a.createElement("div",{className:"pl-2 col-6"},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{title:Ie("fields.email"),placeholder:Ie("fields.email"),type:"text",maxLength:"250",defaultValue:te,onChange:function(e){return ae(e.target.value)},className:"form-control form-control-sm"+(_.email?" is-invalid":"")}),_.email&&i.a.createElement("div",{className:"invalid-feedback"},_.email)))),i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{title:Ie("fields.subject"),className:"form-control form-control-sm"+(_.subject?" is-invalid":""),defaultValue:Y,onChange:function(e){return I(e.target.value)}},i.a.createElement("option",{value:""},Ie("fields.choose_subject")),g.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),_.subject&&i.a.createElement("div",{className:"invalid-feedback"},_.subject)),i.a.createElement("div",{className:"form-group"},i.a.createElement(u.a,{international:!0,className:"form-control form-control-sm"+(_.phone?" is-invalid":""),defaultCountry:ye,placeholder:Ie("fields.enter_phone"),value:W,onChange:X}),_.phone&&i.a.createElement("div",{className:"invalid-feedback"},_.phone),i.a.createElement("small",null,i.a.createElement("i",null,Ie("fields.include_country")))),i.a.createElement("div",{className:"form-group mb-1"},i.a.createElement("textarea",{placeholder:Ie("fields.problem"),maxLength:"500",name:"description",defaultValue:q,onChange:function(e){return G(e.target.value)},className:"form-control form-control-sm"+(_.description?" is-invalid":"")}),_.description&&i.a.createElement("div",{className:"invalid-feedback"},_.description)),i.a.createElement("p",{className:"mb-2"},i.a.createElement("small",null,Ie("fields.choose_day_time",{timezone:Je}))),i.a.createElement("div",{className:"form-group"},i.a.createElement("select",{className:"form-control form-control-sm"+(_.day?" is-invalid":""),defaultValue:T,onChange:function(e){return F(e.target.value)}},i.a.createElement("option",{value:""},Ie("fields.choose_day")),c.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),_.day&&i.a.createElement("div",{className:"invalid-feedback"},_.day)),T&&b.length>0&&i.a.createElement("div",{className:"form-group"},i.a.createElement("select",(t={className:"form-control form-control-sm",defaultValue:L},n()(t,"className","form-control form-control-sm"+(_.time?" is-invalid":"")),n()(t,"onChange",(function(e){return M(e.target.value)})),t),i.a.createElement("option",{value:""},Ie("fields.choose_time")),b.map((function(e){return i.a.createElement("option",{value:e.id},e.name)}))),_.time&&i.a.createElement("div",{className:"invalid-feedback"},_.time)),T&&0==b.length&&i.a.createElement("div",{className:"form-group"},i.a.createElement("i",{className:"material-icons"},"")," ",Ie("fields.loading")),w&&i.a.createElement("div",{className:"alert alert-danger",role:"alert"},w),i.a.createElement("div",{className:"form-group mb-0"},i.a.createElement("button",{type:"button",disabled:me||de,className:"btn btn-sm btn-secondary",onClick:function(){return fe(!0),void o.a.post(e.base_path+"cbscheduler/schedulecb",Re()).then((function(e){y([]),k(null),1==e.data.error?(fe(!1),e.data.messages&&(y(e.data.messages),e.data.messages.errorModal&&Pe(Me+1)),e.data.message&&k(e.data.message)):(je(e.data.data),ve(!0))}))}},de&&i.a.createElement("i",{className:"material-icons"},"")," ",Ie("fields.schedule_callback"))))))}}}]);